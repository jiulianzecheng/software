(()=>{"use strict";var Oe={46664:(i,M,t)=>{t.d(M,{A1:()=>re,A9:()=>ae,Cp:()=>v.Cp,DQ:()=>J,E8:()=>te,F7:()=>be,G8:()=>Pe,Gx:()=>W,Jm:()=>ie,Md:()=>ee,OJ:()=>Z,PK:()=>Se,Qs:()=>ve,Qy:()=>Le,SD:()=>fe,Tf:()=>T,V7:()=>Ie,Wr:()=>$,XG:()=>Me,Xw:()=>ce,Yu:()=>E,bX:()=>U,ct:()=>ue,dC:()=>je,hY:()=>ne,kZ:()=>I,l9:()=>V,ob:()=>de,qi:()=>j,r3:()=>ke,s_:()=>R,sw:()=>De,ty:()=>he,up:()=>Ce,vS:()=>q,vs:()=>Ae,wR:()=>oe,wZ:()=>Be,yV:()=>Q,yY:()=>_e,yk:()=>z,yr:()=>K});var f=t(40684),v=t(52781),r=t(46795),y=t(45465),D=t(48411),d=t(72907),_=t(79619),w=t(63967);const B=(e,s)=>{const a=new Error("[NO SENTRY] "+e);return Object.assign(a,s),a},S=(e,s)=>fetchGetJSON("/api/upper/web_v1/design/readonly_initial?access_token="+e+"&password="+s),F=async(e,s)=>{const a="/api/flat/web_v1/preview/initial?access_token="+e+"&view_mode="+s,n=await fetch(a,{credentials:"same-origin"}),c=await n.json();if(n.status!==200)throw B("[fetchGetHead] failed with "+n.status+": "+a,{status:n.status,error_type:c==null?void 0:c.error_type});return c},E=(e,s)=>(0,r.SN)("/api/upper/web_v1/basics/"+e,{...s}),T=async()=>{let e=[];try{const s=await(0,r.DE)("/api/library/v4/recent_keywords");s!=null&&s.keywords&&(e=s==null?void 0:s.keywords)}catch(s){await(0,d.FY)(s)}return e},R=()=>(0,r.sM)("/api/library/v4/recent_keywords"),W=e=>(0,r.Ds)("/api/library/v4/recent_keywords",{keyword:e}),j=async()=>{if((0,_.Z)())return N();{var e;let s;try{s=await(0,r.DE)("/api/library/v3/project_upper/user_combo_groups")}catch(a){return await(0,d.FY)(a),{}}return{userComboGroupList:(e=s)==null?void 0:e.user_combo_groups}}},N=async()=>{var e;let s;try{s=await(0,r.DE)("/api/library/v3/project_upper/org_combo_groups?org_cid="+MB.user.solo_org.cid)}catch(a){return await(0,d.FY)(a),{}}return{userComboGroupList:(e=s)==null?void 0:e.org_combo_groups}},U=async e=>{var s;let{orgCid:a}=e,n;try{n=await(0,r.DE)("/api/library/v3/project_upper/org_combo_groups?org_cid="+a)}catch(c){return await(0,d.FY)(c),{}}return{orgComboGroupList:(s=n)==null?void 0:s.org_combo_groups}},K=async e=>{const{icon_group:s,market_template:a}=await(0,v.Yk)(e.cid),{source:n,title:c}=s||{},o=await(0,r.DE)(n),u=y.I1[c]||c||"svg",{iconGroupData:h}=(0,y.u2)(o,u);return{iconGroupData:h,marketTemplate:a}},Z=async()=>{if((0,_.Z)())return Y();try{const{asset_groups:e=[]}=await(0,r.Yo)("/api/library/v3/asset_data/me/asset_groups");return e}catch(e){return await(0,d.FY)(e),{userAssetGroupList:[]}}},Y=async()=>{const e=MB.user.solo_org.cid;try{const{asset_groups:s=[],assets:a}=await(0,r.Yo)("/api/library/v6/asset_groups?org_cid="+e);return{userAssetGroupList:s,userAssets:a}}catch(s){return await(0,d.FY)(s),{userAssetGroupList:[]}}},V=async e=>{let{orgCid:s}=e;try{const{asset_groups:a}=await(0,r.Yo)("/api/library/v6/asset_groups?org_cid="+s);return{orgAssetGroupList:a}}catch(a){await(0,d.FY)(a)}},te=async e=>{if((0,_.Z)())return se(e);try{const{asset:s,user_asset:a}=await(0,r.B7)("/api/library/v3/asset_data/me/search_by_url",{image_url:e});return{asset:s,user_asset:a}}catch(s){await(0,d.FY)(s)}},se=async e=>{const s=MB.user.solo_org.cid;try{const{asset:a,flat_asset:n}=await(0,r.B7)("/api/library/v6/assets/search_by_url",{image_url:e,org_cid:s});return{asset:a,user_asset:n}}catch(a){await(0,d.FY)(a)}},$=async(e,s)=>{try{const{asset:a,flat_asset:n}=await(0,r.B7)("/api/library/v6/assets/search_by_url",{image_url:e,org_cid:s});return{asset:a,org_asset:n}}catch(a){await(0,d.FY)(a)}},Ie=async e=>{if((0,_.Z)())return Fe(e);try{const{user_asset_group:s}=await(0,r.uP)("/api/library/v4/users/asset_groups/"+e.cid,{...e});return{user_asset_group:s}}catch(s){await(0,d.FY)(s)}},ae=async(e,s)=>{const{name:a,parentCid:n=null,position:c}=s,{asset_group:o}=await(0,r.zi)("/api/library/v6/asset_groups",{org_cid:e,name:a,parent_cid:n,position:c});return{asset_group:o}},Fe=async e=>{const{cid:s,name:a,parent_cid:n,position:c}=e;try{const{asset_group:o}=await(0,r.uP)("/api/library/v6/asset_groups/"+s,{name:a,parent_cid:n,position:c});return{user_asset_group:o}}catch(o){await(0,d.FY)(o)}},re=async e=>{const{cid:s,name:a,parent_cid:n,position:c}=e;try{const{asset_group:o}=await(0,r.uP)("/api/library/v6/asset_groups/"+s,{name:a,parent_cid:n,position:c});return{org_asset_group:o}}catch(o){await(0,d.FY)(o)}},oe=async e=>{if((0,_.Z)())return xe(e);try{return await(0,r.uP)("/api/library/v3/asset_data/me/assets/"+e.asset_cid,{...e})}catch(s){await(0,d.FY)(s)}},ie=async e=>(await(0,r.SN)("/api/library/v6/asset_groups/",{asset_groups:e})).asset_groups,ke=async(e,s)=>{const{name:a,groupCid:n}=s;return await(0,r.SN)("/api/library/v6/assets",{cids:e,name:a,group_cid:n})},xe=async e=>{try{return await(0,r.uP)("/api/library/v6/assets",{...e})}catch(s){await(0,d.FY)(s)}},ne=async e=>{let{cids:s,...a}=e;try{return await(0,r.uP)("/api/library/v6/assets",{cids:s,...a})}catch(n){await(0,d.FY)(n)}},ce=async e=>{let{assetCid:s,name:a,groupCid:n}=e;if((0,_.Z)())return le({assetCid:s,name:a,groupCid:n});try{await(0,r.B7)("/api/library/v3/asset_data/me/assets",{cid,name:a,group_cid:n})}catch(c){await(0,d.FY)(c)}},le=async e=>{let{assetCid:s,name:a,groupCid:n}=e;try{await(0,r.B7)("/api/library/v6/assets",{asset_cid:[s],name:a,group_cid:n})}catch(c){await(0,d.FY)(c)}},de=async e=>{let{assetCid:s,name:a,groupCid:n}=e;try{const c=await(0,r.B7)("/api/library/v6/assets",{asset_cid:[s],name:a,group_cid:n});return c==null?void 0:c.cid}catch(c){await(0,d.FY)(c)}},I=async e=>{let{org_cid:s,name:a,group_cid:n}=e;if((0,_.Z)())return pe({org_cid:s,name:a,group_cid:n});try{return(0,r.B7)("/api/library/v3/asset_data/org/asset_group_from_user",{user_asset_group_cid,org_cid:s,org_asset_group_cid})}catch(c){await(0,d.FY)(c)}},pe=async e=>{let{org_cid:s,name:a,group_cid:n}=e;try{return(0,r.B7)("/api/library/v6/asset_groups",{org_cid:s,name:a,parent_cid:null,group_cid:n,position:-99})}catch(c){await(0,d.FY)(c)}},ue=async e=>{const s=MB.user.solo_org.cid;if((0,_.Z)())return ge(s);try{const{user_asset_group:a,user_assets:n}=await(0,r.Yo)("/api/library/v3/asset_data/me/asset_groups/"+e);return{user_asset_group:a,userAssets:n}}catch(a){await(0,d.FY)(a)}},ge=async e=>{const s=MB.user.solo_org.cid;try{const{asset_group:a,assets:n}=await(0,r.Yo)("/api/library/v6/asset_groups?org_cid="+s);return{user_asset_group:a,userAssets:n}}catch(a){await(0,d.FY)(a)}},J=async e=>{const s=MB.currentOrg.cid;try{const{asset_group:a,assets:n}=await(0,r.Yo)("/api/library/v6/asset_groups?org_cid="+s);return{org_asset_group:a,orgAssets:n}}catch(a){await(0,d.FY)(a)}},Le=async e=>{(0,_.Z)()?await ye(e):await(0,r.sM)("/api/library/v3/asset_data/me/assets/"+e.cid)},ye=async e=>{await(0,w.uz)("/api/library/v6/assets",{cids:[e.cid]})},q=async e=>{await(0,w.uz)("/api/library/v6/assets",{cids:[e.cid]})},he=async e=>{(0,_.Z)()?await me(e):await(0,r.sM)("/api/library/v3/asset_data/me/asset_groups/"+e)},me=async e=>{await(0,r.sM)("/api/library/v6/asset_groups/"+e)},Q=async e=>{await(0,r.sM)("/api/library/v6/asset_groups/"+e)},fe=e=>(0,r.iv)("/preferences/update",{...e}),ve=async(e,s)=>{if((0,_.Z)())return we(e,s);try{return await(0,r.uP)("/api/library/v4/users/asset_groups/"+e,{...s})}catch(a){await(0,d.FY)(a)}},we=async(e,s)=>{const a=MB.user.solo_org.cid;try{return await(0,r.uP)("/api/library/v6/asset_groups/"+e,{...s,org_cid:a})}catch(n){await(0,d.FY)(n)}},Me=e=>async(s,a)=>{try{const n={...a,org_cid:e};return await(0,r.uP)("/api/library/v6/asset_groups/"+s,{...n})}catch(n){await(0,d.FY)(n)}},_e=async(e,s)=>{let a=null;try{const n=await(0,r.Yo)("/api/community/v1/workspace?category="+e+"&plabel="+s);n!=null&&n.market_templates&&(a=n==null?void 0:n.market_templates)}catch(n){await(0,d.FY)(n)}return a},ee=async(e,s)=>{let a=null;try{const n=s.name===D.bp.All?"&scene_tag="+e:"&scene_tag="+e+"&plabel="+s.name+"&plabel_id="+s.id,c=await(0,r.Yo)("/api/community/v1/workspace/v8_combos?category="+f.t_+n);c!=null&&c.market_templates&&(a=c==null?void 0:c.market_templates)}catch(n){await(0,d.FY)(n)}return a},be=async e=>{let s=null,a=null;try{const n=await(0,r.DE)("/flpak/ww-p2wsearch?"+e);if(n!=null&&n.data){const c=n.data,{user_flat_assets:o,user_flat_asset_groups:u,org_flat_assets:h,org_flat_asset_groups:g}=c.asset||{};s={...c,asset:{user_assets:o,user_asset_groups:u,org_assets:h,org_asset_groups:g}},a=n.p2mMMap}}catch(n){await(0,d.FY)(n)}return{data:s,p2mMMap:a}},Ae=async e=>{let s=null;try{const a=await(0,r.DE)("/flpak/ww-p2meta/"+e);a!=null&&a.length&&(s=a)}catch(a){await(0,d.FY)(a)}return s},Pe=async e=>{let{currentComboPanel:s,projectMetaCid:a}=e;try{await(0,r.zi)("/flpak/ww-migrate-"+s+"-combo-group/"+a+"?mode=normal")}catch(n){await(0,d.FY)(n)}},z=async e=>{let{projectBasicCid:s}=e;try{const{userId:a,flatKey:n}=await(0,r.DE)("/api/flat/web_v1/proj2-edit-info?prj2Cid="+s);return{userId:a,flatKey:n}}catch(a){await(0,d.FY)(a)}},Te=async e=>{let{projectBasicCid:s,accessToken:a,password:n}=e;try{const{userId:c,flatKey:o}=await fetchGetJSON("/api/flat/web_v1/proj2-preview-info?prj2Cid="+s+"&access_token="+a+"&password="+n);return{userId:c,flatKey:o}}catch(c){await apiErrorModals(c)}},Ce=e=>(0,r.DE)("/api/dashboard/v5/orgs/"+e),De=async e=>{const{project:s}=await(0,r.DE)("/api/dashboard/v5/projects/"+e);return s},Be=async e=>(0,r.DE)("/api/upper/web_v1/basics/statstics/"+e),je=async()=>{try{const{result:e}=await(0,r.DE)("/api/community/v1/community/scene_tag_labels?label_type=combo_group");return e}catch(e){console.log(e)}},Se=async e=>{try{const{stickers:s}=await(0,r.zi)("/api/community/v1/sticker_search",{q:e,page:1,page_size:200});return s}catch(s){return console.log(s),[]}}},41449:(i,M,t)=>{t.d(M,{Dw:()=>v,H:()=>y,QQ:()=>D,o$:()=>f});const f="/proto",v=w=>f+"/"+w,r=w=>{const B=/^\/proto\/design\/(?:([^/]+?))$/i.exec(w);return B?B[1]:new Error("project cid error")},y=w=>{let{search:B,pathname:S}=w;if(S.includes("/sharing"))return S.includes("dashboard")||S.includes("htmlzip")?S.split("/").at(-3):S.includes("embed/v2")?location.pathname.split("/").at(-4):S.split("/").at(-2);{const F=new URLSearchParams(B).get("token");if(F)return F;const E=/^\/proto\/([^/]+?)(?:\/forum|\/uichina|\/embed|\/embed\/v2|\/htmlzip|\/sharing|\/ro)?\/?$/i.exec(S);return E?E[1]:""}},D="/p2mkt_view",d=w=>D+"/"+w,_=w=>/^\/p2mkt_view\/(?:([^/]+?))$/i.exec(w)[1]},42276:(i,M,t)=>{var f=t(26114),v=t(94947),r=t(39208),y=t(56656);const D={"sk-bouncedelay":"ZdD58bXGNcNoQjiPeXLu"},d={"sk-bouncedelay":"ZBrU7Yes6CevGkk6hArA"};t(16708),t(85991),t(97381);var _=t(74059),w=t(51044),B=t(46479),S=t(83140),F=t(72605),E=t(17887),T=t(54852),R=t(55793),W=t(39271),j=t(57464);class N extends w.PureComponent{constructor(o){super(o);const{store:u,projectBasic:h,projectMeta:g,isHtmlZip:b}=o,P=new URLSearchParams(location.search);let C="",l="";P.get("view_mode")==="read_only"&&(C=P.get("screen")||"",l=P.get("canvasId")||""),this.state={visibleIsEmpty:!1};try{const m=(0,W.rV)(C);u.dispatch({type:"entry:root-project:readOnly:activate",payload:{projectBasic:h,projectMeta:g,screenCid:m,canvasCid:l,isHtmlZip:b}})}catch(m){this.state={visibleIsEmpty:!0}}}componentDidMount(){this.props.onComponentDidMount()}render(){const{store:o}=this.props;return this.state.visibleIsEmpty?(0,R.V)():(0,j.jsx)(F.Kq,{store:o,children:(0,j.jsx)(T.A,{children:(0,j.jsx)(E.A,{})})})}}var U=t(82218);const K=async c=>{let{projectMetaCid:o}=c;await(0,U.F2)({userId:void 0,flpakKey:o,onTransferError:U.z0,onReadOnlyError:U.sH,isDummyCmt:!0,__fetchFlpakAsync:v.BD},void 0)};var Z=t(98148);const Y=function(c,o,u){const h=o.getGuidesData()||"[]",g=new Set(JSON.parse(h)),b=new Set,P=new Map,C={checkGuideHasShown:l=>g.has(l),checkGuideToBeShown:l=>b.has(l),getState:()=>({commonGuidesHasShown:Array.from(g),commonGuidesToBeShown:Array.from(b),mountGuidesMap:P}),tryToShowGuide:l=>{var m;if(g.has(l)||!((m=MB)!=null&&(m=m.user)!=null&&m.id))return;const A=document.getElementById("MD_"+l);if(A){A.style.display="block";return}b.add(l),(0,Z.o)(l,c,u)},markGuideAsRead:l=>{g.add(l),o.setGuidesData(JSON.stringify(Array.from(g)))},batchMarkGuideAsRead:l=>{l.forEach(m=>g.add(m)),o.setGuidesData(JSON.stringify(Array.from(g)))},closeAndMarkGuideAsRead:l=>{C.checkGuideHasShown(l)||(C.closeGuide(l),C.markGuideAsRead(l))},closeGuide:l=>{const m=document.getElementById("MD_"+l);m&&m.parentNode&&m.parentNode.removeChild(m)},closeAllGuide:()=>{const l=document.getElementById("GUIDES");l&&l.parentNode&&l.parentNode.removeChild(l)},removeGuide:l=>{g.delete(l),o.setGuidesData(JSON.stringify(Array.from(g)))},tryToContinueMountGuide:(l,m)=>{const A=P.get(l);A&&typeof(A==null?void 0:A.handleContinue)=="function"&&A.handleContinue(m)},tryToResizeMountGuide:l=>{const m=P.get(l);m&&typeof(m==null?void 0:m.handleResize)=="function"&&m.handleResize()},tryToCloseMountGuide:l=>{const m=P.get(l);m&&typeof(m==null?void 0:m.handleClose)=="function"&&m.handleClose()},registerMountGuideCallback:(l,m)=>{const A=P.get(l)||{};P.set(l,{...A,...m})},removeMountGuideCallback:(l,m)=>{if(!m){P.delete(l);return}const A=P.get(l)||{};P.set(l,{...A,[m]:void 0})}};return C},V=c=>{let{store:o,commonGuidesData:u,isDesign:h,isPreview:g}=c;MB.commonGuideHelper=Y(o,{getGuidesData:()=>u,setGuidesData:updateUserCommonGuidesData},{isDesign:h,isPreview:g})},te=c=>{let{store:o,isDesign:u,isPreview:h}=c;const g={guide:{dashboard_guides:"",workspace_guides:"",square_guides:null,workspace_guides_version:"",default_team_cid:"",root_project_team_cid:"",workspace_guides_2203:"",workspace_guides_2203_version:"",aboard_guides:""},guide_project_template_cid:"",guide_project_template_2203_cid:"",guide_flow_template_cid:"",guide_design_template_cid:"",guide_prototype_template_cid:""},{guide:{workspace_guides:b}}=g;MB.commonGuideHelper=Y(o,{getGuidesData:()=>b,setGuidesData:()=>{}},{isDesign:u,isPreview:h})};var se=t(77757),$=t(25058),Ie=t(88753),ae=t(42226),Fe=t(68673),re=t(29601),oe=t(79619);const ie=c=>{let{initialData:o,designOptions:u,global:h,onUpdateSharing:g}=c;const{user:b,org:P,team:C,preference:l,orgList:m,user_fcg:A,org_fcg:O,space:G,canEditByCurrentUser:k}=o,{currentUser:x,currentOrg:L}=(0,oe.n)({user:b,org:P});(0,ae.kZ)((0,re.w)()),Object.assign(MB,{user:x||{},currentOrg:L,canEditByCurrentUser:k,global:{...h,popupHelper:(0,$.L)(),experienceLoginModalHelper:se.F}}),MB.action("current:update:state",{currentOrg:L,currentTeam:C,currentUser:x,orgList:m,user_fcg:A,org_fcg:O,currentSpace:G}),MB.action("update:design:options",{designOptions:u}),b!=null&&b.id&&MB.action("entry:init:preference",{preference:l}),g&&g()},ke=async c=>{let{designStore:o}=c,u="[]";try{const{guide:h}=await requestUserCommonGuidesData();u=h==null?void 0:h.workspace_guides}catch(h){console.error("\u83B7\u53D6 guide_data \u5931\u8D25")}await initCommonGuide({store:o,commonGuidesData:u,isDesign:!0,isPreview:!1})},xe=async c=>{let{type:o,projectBasicCid:u}=c;switch(o){case DesignType.Design:return requestProjectFullDataFlat(u);case DesignType.Experience:return requestExperienceFullDataFlat(u);default:throw new Error(o+" not found in known design types for "+u)}};var ne=t(66778),ce=t(64334),le=t(60310),de=t(12201),I=t(9376);const pe=c=>{const{isEmbedV1:o=!1}=c||{};return{isDesktop:!((0,I.Fr)()||o),isInApp:!1,isMultiLink:!1,isMobile:(0,I.Fr)(),isIOSClient:(0,I.Hv)(),isStandAlone:(0,I.Gd)(),isEmbedV1:o,isEmbedV2:!1,isHTMLZip:!1,isUIChina:(0,I.II)(),isForum:(0,I.uf)(),isElectron:(0,I.b8)(),isSquare:!1,isFeishu:(0,I.Fl)(),isWechat:(0,I.vq)(),...c}},ue=c=>{const{isMobile:o,isEmbedV2:u,isSquare:h}=c;return o?le.A:u||h?ce.A:de.A},ge=c=>{let{designOptions:o,previewOptions:u,initialData:h,onComponentDidMount:g,sharing:b}=c,P=!1;const C=(0,S.s)(MB);ie({initialData:h,designOptions:o,global:{designOptions:o,previewOptions:u}});const{isIOSClient:l,isStandAlone:m}=u;(m||l)&&(document.documentElement.style.height="100vh");const{runnerController:A,messageBucket:O,webpackInterface:G,PreviewApp:k}=(0,ne._)(ue(u));return Object.assign(MB,{runnerController:A,messageBucket:O,webpackInterface:G,global:{...MB.global||{},popupHelper:(0,$.L)(),designOptions:o,previewOptions:u}}),MB.webpackInterface.store.dispatch({type:"preview:update:state",payload:{previewOptions:u}}),{requestData:async()=>{const{user:x,org:L,preference:X,project_basic:H,project_meta:Re}=h;return te({store:C,isDesign:!0,isPreview:!1}),Object.assign(MB,{tag:H==null?void 0:H.version}),MB.action("update:design:options",{designOptions:MB.global.designOptions}),await K({projectMetaCid:Re.cid}),MB.webpackInterface.store.dispatch({type:"preview:set:current-projectShare",payload:{projectShare:b}}),MB.webpackInterface.store.dispatch({type:"entry:init:preview:preference",payload:{preference:X||{}}}),Object.assign(MB,{user:x||{},canEditByCurrentUser:!1,org:L||void 0}),MB.webpackInterface.store.dispatch({type:"entry:state:init"}),P=!0,{projectAlike:H,projectMeta:Re,projectShare:b}},renderDesign:x=>{let{projectAlike:L,projectMeta:X}=x;return P?(0,j.jsx)(N,{store:C,projectBasic:L,projectMeta:X,onComponentDidMount:g,isHtmlZip:!0}):null},renderPreview:x=>{let{projectAlike:L,projectMeta:X,projectShare:H}=x;return P?((0,R.X)(H),(0,j.jsx)(k,{store:G.store,previewMode:"preview",projectAlike:L,projectMeta:X,projectShare:H})):null}}};var J=t(21676);const Le=J.Ay.div.withConfig({displayName:"styles__StyledExampleApp",componentId:"sc-1e7mzg5-0"})(["&{position:absolute;top:0;left:0;bottom:0;right:0;transition:all 0.2s ease-in-out;.loading-container{position:absolute;top:50%;left:50%;.mb-loading{width:80px;height:80px;margin-top:-40px;margin-left:-40px;}.chris-icon{position:absolute;left:68%;top:-8%;}}}.mb-design-page{height:100%;&,#mb-toolbar{transition:all 0.2s ease-in-out;}&.is-collapse{opacity:0;z-index:0;#mb-toolbar{transform:translateY(-100%);}.mb-right-panel{transform:translateX(100%);}}}.mb-preview-page{position:absolute;top:0;left:0;width:100%;bottom:0;font-size:12px;transition:all 0.2s ease-in-out;&.is-collapse{opacity:0;z-index:0;}}"]),ye=J.Ay.div.withConfig({displayName:"styles__StyledROExampleApp",componentId:"sc-1e7mzg5-1"})(["&{position:absolute;top:0;left:0;bottom:0;right:0;transition:all 0.2s ease-in-out;.loading-container{position:absolute;top:50%;left:50%;.mb-loading{width:80px;height:80px;margin-top:-40px;margin-left:-40px;}.chris-icon{position:absolute;left:68%;top:-8%;}}}.mb-design-page{height:100%;position:relative;z-index:1;&.is-collapse{opacity:0;z-index:0;}}.mb-preview-page{position:absolute;top:0;left:0;width:100%;bottom:0;font-size:12px;&.is-collapse{opacity:0;z-index:0;}}"]);var q=t(1694),he=t(21952),me=t(86634),Q=t.n(me);class fe extends w.PureComponent{render(){const{isCollapse:o,renderReadOnly:u,projectAlike:h,projectMeta:g}=this.props;return(0,j.jsx)("div",{ref:b=>this.$element=b,className:Q()("mb-design-page",{"is-collapse":o}),children:u({projectAlike:h,projectMeta:g})})}}class ve extends w.PureComponent{constructor(o){super(o),(0,_.A)(this,"setElementRef",u=>this.$element=u),MB.f.inPreview=!o.isCollapse}componentDidMount(){this.$element.addEventListener("wheel",this.handleWheel,{passive:!1})}componentWillUnmount(){MB.f.inPreview=!1,this.$element.removeEventListener("wheel",this.handleWheel)}handleWheel(o){(o.ctrlKey||o.metaKey)&&o.preventDefault()}render(){const{isCollapse:o,renderPreview:u,projectAlike:h,projectMeta:g,projectShare:b}=this.props;return(0,j.jsx)("div",{ref:this.setElementRef,className:Q()("mb-preview-page",{"is-collapse":o}),children:u({projectAlike:h,projectMeta:g,projectShare:b})})}}var we=t(99734),Me=t(14941),_e=t(86431),ee=t(24013),be=t(31900),Ae=t(15139),Pe=t(40684),z=t(76445),Te=t(6637);const Ce=c=>{const{current:{currentProject:o},ui:{toolbar:{isShowSticky:u},leftLayout:{leftPanel:{show:h,width:g},directory:{screen:{currentPage:b},bottom:{height:P},screen:{screenCollapseKeySet:C}}},rightLayout:{rightPanel:{show:l,resizedWidth:m}},fixedLayout:{modals:{previewCanvasModal:A,previewModal:O}}},editor:{state:{mode:{fullScreenMode:G}}}}=MB.__store__.getState(),k=()=>{const{pageKey:x,canvasKey:L}=Ae.A.validateAndTryCorrectPGAndCVKey(b.key,c,null,o.category===Pe.t_);MB.webpackInterface.store.dispatch({type:"entry:runner:activate:canvas",payload:{pageKey:x,canvasKey:L,saveHistory:!1,forceInit:!0,keepScale:!1}}),MB.webpackInterface.store.dispatch({type:"preview:set:leftPaneWidth",payload:{leftPaneWidth:g!=null?g:250}}),MB.webpackInterface.store.dispatch({type:"preview:update:state",payload:{hasChangedScaleManually:!1}}),MB.webpackInterface.store.dispatch({type:"preview:panel:set:height",payload:{panelHeight:P}}),MB.webpackInterface.store.dispatch({type:"preview:set:rightPaneWidth",payload:{rightPaneWidth:m,projectCid:o.cid}}),G&&MB.webpackInterface.store.dispatch({type:"reducer:preview-toolbar:fullscreen",payload:{isFullScreenMode:!0}}),MB.webpackInterface.store.dispatch({type:"ST:update",payload:{STMode:u}}),MB.webpackInterface.store.dispatch({type:"entry:preview-setting:toggle:isMinimized",payload:{isMinimized:!h,isMemorize:!G}}),MB.webpackInterface.store.dispatch({type:"entry:preview-setting:toggle:rightPane",payload:{isShowRightPane:l,isMemorize:!G}}),MB.webpackInterface.store.dispatch({type:"preview:set:collapsedRBPageKeySet",payload:{collapsedRBPageKeySet:C}}),MB.webpackInterface.store.dispatch({type:"entry:preview:toggle:isHiddenToolBar",payload:{value:!1}}),MB.action("modal:reset:state"),MB.action("entry:exit:edit:basket"),MB.__store__.dispatch({type:"entry:comment:disabled",payload:{noWigglingCommentCid:!0}}),MB.__store__.dispatch(z.GO.toggleInspectMode(!1)),MB.__store__.dispatch(z.GO.toggleHandMode(!1)),MB.__store__.dispatch(z.GO.select([])),MB.__store__.dispatch({type:"elbow:update",payload:{isInElbowMode:!1}}),MB.__store__.dispatch({type:"entry:ST:STMode:disable"}),MB.__store__.dispatch({type:"ST:clear"})};A!=null&&A.isOpen||O!=null&&O.isOpen?(MB.action("modal:reset:preview:modal:state"),setTimeout(()=>{k()},600)):k()},De=(c,o)=>{const{container:{current:{rootProject:u},common:{leftPaneWidth:h,panelHeight:g,rightPaneWidth:b,collapsedRBPageKeySet:P},runner:{activePageKey:C},previewSetting:{isFullScreenMode:l,isMinimized:m,isShowRightPane:A}},ST:{STMode:O}}=MB.webpackInterface.store.getState(),{ui:{leftLayout:{directory:{screen:{currentPage:G}}}},editor:{state:{mode:{isHtmlZipPreview:k}}}}=MB.__store__.getState();G.key!==C&&MB.__store__.dispatch({type:"entry:root-project:readOnly:activate",payload:{projectBasic:c,projectMeta:o,screenCid:C,isHtmlZip:k}}),MB.__store__.dispatch({type:"screen:add:collapseKeySet",payload:{refs:P,projectCid:u.cid}}),l&&MB.__store__.dispatch(z.GO.toggleFullScreenMode(!0)),MB.webpackInterface.store.dispatch({type:"entry:runner:cleanup:audio"}),MB.webpackInterface.store.dispatch({type:"runner:reset:state:except:history"}),MB.webpackInterface.store.dispatch({type:"container:comment:reset:state"}),MB.webpackInterface.store.dispatch({type:"preview:previewPanel:navindex",payload:{previewPanelNavIndex:0}}),MB.__store__.dispatch({type:"left-panel:set:width",payload:{width:h,projectCid:u.cid}}),MB.__store__.dispatch({type:"directory-panel:bottom:set:height",payload:{height:g}}),MB.__store__.dispatch({type:"right-side-panel:update:resize:width",payload:{width:b,projectCid:u.cid}}),MB.__store__.dispatch({type:"right-side-panel:collapse:panel",payload:{show:A,isMemorize:!l}}),MB.__store__.dispatch({type:"left-panel:collapse:panel:show",payload:{show:!m,isMemorize:!l}}),MB.__store__.dispatch({type:"entry:observe:dom:size:update-viewport-rect"}),MB.__store__.dispatch({type:"entry:isShowSticky:toggle",payload:{isShowSticky:O}}),requestAnimationFrame(()=>MB.__store__.dispatch({type:"entry:update:viewport:rect"})),MB.webpackInterface.store.dispatch({type:"entry:comment:disabled"}),(0,Te.RF)(C)};class Be extends w.PureComponent{constructor(o){super(o),(0,_.A)(this,"handleWheelChanged",A=>{if(A.deltaX===0)return;const O=document.getElementById("workspace"),G=O.scrollLeft+O.offsetWidth===O.scrollWidth&&A.deltaX>0,k=O.scrollLeft===0&&A.deltaX<0;(G||k)&&A.preventDefault()}),(0,_.A)(this,"handleDesignDidMount",()=>{MB.reduxEntry.setEntryMap(we.T),this.setState({isLoading:!1})}),(0,_.A)(this,"keyboardManager",new q.Rr);const{viewMode:u,designOptions:h,previewOptions:g,initialData:b,sharing:P}=o;MB.switchToPreview=A=>{this.state.viewMode!=="device"&&((0,ee.N8)("device"),Ce(A),this.setState({viewMode:"device"}))},MB.switchToReadOnly=()=>{if(this.state.viewMode==="read_only")return;const{projectAlike:A,projectMeta:O}=this.state;(0,ee.N8)("read_only"),De(A,O),this.setState({viewMode:"read_only"})},this.state={isLoading:!0,isDataLoaded:!1,viewMode:u,projectAlike:null,projectMeta:null,projectShare:void 0};const{requestData:C,renderDesign:l,renderPreview:m}=ge({initialData:b,designOptions:h,previewOptions:g,onComponentDidMount:this.handleDesignDidMount,sharing:P});this.requestData=C,this.renderDesign=l,this.renderPreview=m}componentDidMount(){Promise.all([this.requestData()]).then(o=>{let[{projectAlike:u,projectMeta:h,projectShare:g}]=o;this.setState({projectAlike:u,projectMeta:h,projectShare:g},()=>{this.setState({isDataLoaded:!0})});const b=document.getElementById("workspace");b&&b.addEventListener("wheel",this.handleWheelChanged)})}componentWillUnmount(){const o=document.getElementById("workspace");o&&o.removeEventListener("wheel",this.handleWheelChanged,{capture:!0})}render(){const{isLoading:o,isDataLoaded:u,viewMode:h,projectAlike:g,projectMeta:b,projectShare:P}=this.state,{renderDesign:C,renderPreview:l}=this;return(0,j.jsx)(be.G.Provider,{value:h,children:(0,j.jsx)(q.M.Provider,{value:this.keyboardManager,children:(0,j.jsx)(he.$,{children:(0,j.jsxs)(ye,{className:"example-app",children:[u&&(0,j.jsx)(fe,{isCollapse:h!=="read_only",projectAlike:g,projectMeta:b,renderReadOnly:C}),u&&(0,j.jsx)(ve,{isCollapse:h!=="device",projectAlike:g,projectMeta:b,projectShare:P,renderPreview:l}),o&&(0,j.jsxs)("div",{className:"loading-container",children:[(0,j.jsx)(B.Tw,{className:"mb-loading"}),(0,_e.X)()&&(0,j.jsx)(Me.n,{className:"chris-icon"})]})]})})})})}}var je=t(36820),Se=t(88223),e=t(10286),s=t(36429);t.p="./mb-proto2/";const a=document.getElementById("workspace"),n=async()=>{var c,o;const u=pe({isHTMLZip:!0});(0,I.Fr)()&&((c=document.querySelector("body"))==null||c.classList.add("mobile"));let h=await(0,v.Rz)();const{projectUpper:g,projectMeta:b}=h;h={...h,projectName:g.name,project_basic:g,project_meta:b};const{sharing:P}=await(0,e.J_)({project:g}),{generateLang:C}=await s.qu.loadLLG();await C(),document.title=""+(0,Se.qk)(g.name||g.title),!ENV.IS_ON_PREMISES&&(0,je.I2)();const l=(o=new URLSearchParams(location.search))==null?void 0:o.get("view_mode"),m=window.HZv5_PREVIEW_MODE||"",A=l?l==="device":m==="device",O={isDesign:!0,isExperience:!1,isLoggedExperience:!1};(0,f.H)(a).render((0,j.jsx)(Be,{initialData:h,viewMode:A?"device":"read_only",designOptions:O,previewOptions:u,sharing:P}))};document.addEventListener("DOMContentLoaded",async()=>{await n()})},9376:(i,M,t)=>{t.d(M,{Bd:()=>Z,Fl:()=>d,Fr:()=>F,Gd:()=>j,H8:()=>w,Hv:()=>W,II:()=>N,Md:()=>K,b8:()=>r,cX:()=>y,gm:()=>B,lg:()=>Y,m0:()=>E,nr:()=>S,uF:()=>D,uf:()=>U,vq:()=>_});var f,v;const r=()=>window.MB_DESKTOP_VERSION||window.isElectron||/Electron/i.test(navigator.userAgent),y=()=>/(Macintosh)/i.test(navigator.userAgent),D=()=>/(Windows)/i.test(navigator.userAgent),d=()=>/(Lark)/i.test(navigator.userAgent),_=()=>/MicroMessenger/i.test(navigator.userAgent),w=()=>/Chrome/i.test(navigator.userAgent),B=()=>/Firefox/i.test(navigator.userAgent),S=()=>/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent),F=()=>{const V=new URLSearchParams(location.search);return V&&V.get("inapp")==="1"&&(t.g.isInAPP=!0),/(iPod|iPhone|iPad|Android|MobileClient)/.test(navigator.userAgent)||window.isInAPP},E=()=>/Android/i.test(navigator.userAgent),T=()=>/(iPad)/.test(navigator.userAgent),R=()=>/(iPod|iPhone|iPad)/.test(navigator.userAgent),W=()=>!!(window.webkit&&window.webkit.messageHandlers),j=()=>navigator.standalone,N=()=>/\/uichina$/.test(location.pathname),U=()=>/\/forum$/.test(location.pathname),K=()=>/(MobileClient)/.test(navigator.userAgent),Z=!!(typeof window<"u"&&window.document&&window.document.createElement),Y=/(mac|iphone|ipod|ipad)/i.test(typeof navigator<"u"?((f=navigator)==null?void 0:f.platform)||((v=navigator)==null||(v=v.userAgentData)==null?void 0:v.platform):"")},16700:i=>{i.exports=canvg},94994:i=>{i.exports=dompurify},9820:i=>{i.exports=html2canvas}},Ee={};function p(i){var M=Ee[i];if(M!==void 0)return M.exports;var t=Ee[i]={id:i,loaded:!1,exports:{}};return Oe[i].call(t.exports,t,t.exports,p),t.loaded=!0,t.exports}p.m=Oe,p.amdO={},(()=>{var i=[];p.O=(M,t,f,v)=>{if(t){v=v||0;for(var r=i.length;r>0&&i[r-1][2]>v;r--)i[r]=i[r-1];i[r]=[t,f,v];return}for(var y=1/0,r=0;r<i.length;r++){for(var[t,f,v]=i[r],D=!0,d=0;d<t.length;d++)(v&!1||y>=v)&&Object.keys(p.O).every(E=>p.O[E](t[d]))?t.splice(d--,1):(D=!1,v<y&&(y=v));if(D){i.splice(r--,1);var _=f();_!==void 0&&(M=_)}}return M}})(),p.n=i=>{var M=i&&i.__esModule?()=>i.default:()=>i;return p.d(M,{a:M}),M},(()=>{var i=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,M;p.t=function(t,f){if(f&1&&(t=this(t)),f&8||typeof t=="object"&&t&&(f&4&&t.__esModule||f&16&&typeof t.then=="function"))return t;var v=Object.create(null);p.r(v);var r={};M=M||[null,i({}),i([]),i(i)];for(var y=f&2&&t;typeof y=="object"&&!~M.indexOf(y);y=i(y))Object.getOwnPropertyNames(y).forEach(D=>r[D]=()=>t[D]);return r.default=()=>t,p.d(v,r),v}})(),p.d=(i,M)=>{for(var t in M)p.o(M,t)&&!p.o(i,t)&&Object.defineProperty(i,t,{enumerable:!0,get:M[t]})},p.f={},p.e=i=>Promise.all(Object.keys(p.f).reduce((M,t)=>(p.f[t](i,M),M),[])),p.u=i=>""+{703:"lazy-lib-rehype",956:"lazy-lib-i18n",976:"lazy-lib-dl"}[i]+"-"+{703:"f1953540fb6d5bc8a699",956:"ae260ffb29ed3163ae8f",976:"ea72883bd82bab66e6fc"}[i]+".js",p.miniCssF=i=>{},p.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(i){if(typeof window=="object")return window}}(),p.o=(i,M)=>Object.prototype.hasOwnProperty.call(i,M),(()=>{var i={},M="@mb2023/mb-proto:";p.l=(t,f,v,r)=>{if(i[t]){i[t].push(f);return}var y,D;if(v!==void 0)for(var d=document.getElementsByTagName("script"),_=0;_<d.length;_++){var w=d[_];if(w.getAttribute("src")==t||w.getAttribute("data-webpack")==M+v){y=w;break}}y||(D=!0,y=document.createElement("script"),y.charset="utf-8",y.timeout=120,p.nc&&y.setAttribute("nonce",p.nc),y.setAttribute("data-webpack",M+v),y.src=t),i[t]=[f];var B=(F,E)=>{y.onerror=y.onload=null,clearTimeout(S);var T=i[t];if(delete i[t],y.parentNode&&y.parentNode.removeChild(y),T&&T.forEach(R=>R(E)),F)return F(E)},S=setTimeout(B.bind(null,void 0,{type:"timeout",target:y}),12e4);y.onerror=B.bind(null,y.onerror),y.onload=B.bind(null,y.onload),D&&document.head.appendChild(y)}})(),p.r=i=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},p.nmd=i=>(i.paths=[],i.children||(i.children=[]),i),p.j=699,p.p="/mb-proto2/",(()=>{var i={699:0};p.f.j=(f,v)=>{var r=p.o(i,f)?i[f]:void 0;if(r!==0)if(r)v.push(r[2]);else{var y=new Promise((w,B)=>r=i[f]=[w,B]);v.push(r[2]=y);var D=p.p+p.u(f),d=new Error,_=w=>{if(p.o(i,f)&&(r=i[f],r!==0&&(i[f]=void 0),r)){var B=w&&(w.type==="load"?"missing":w.type),S=w&&w.target&&w.target.src;d.message="Loading chunk "+f+" failed.\n("+B+": "+S+")",d.name="ChunkLoadError",d.type=B,d.request=S,r[1](d)}};p.l(D,_,"chunk-"+f,f)}},p.O.j=f=>i[f]===0;var M=(f,v)=>{var[r,y,D]=v,d,_,w=0;if(r.some(S=>i[S]!==0)){for(d in y)p.o(y,d)&&(p.m[d]=y[d]);if(D)var B=D(p)}for(f&&f(v);w<r.length;w++)_=r[w],p.o(i,_)&&i[_]&&i[_][0](),i[_]=0;return p.O(B)},t=self.webpackChunk_mb2023_mb_proto=self.webpackChunk_mb2023_mb_proto||[];t.forEach(M.bind(null,0)),t.push=M.bind(null,t.push.bind(t))})(),p.nc=void 0,p.O(void 0,[31,788,908,347],()=>p(33129)),p.O(void 0,[31,788,908,347],()=>p(69321));var Ge=p.O(void 0,[31,788,908,347],()=>p(42276));Ge=p.O(Ge)})();

//# sourceMappingURL=preview-html-zip-16b4d3dfc7080bf6762b.js.map